---
# ServiceEntry for minio External Access
apiVersion: networking.istio.io/v1beta1
kind: ServiceEntry
metadata:
  name: minio-external
  namespace: istio-system
spec:
  hosts:
    - "minio.philippmhauptmann.me"
  addresses:
    - 100.93.45.8
  ports:
    - number: 443
      name: https
      protocol: HTTPS
  location: MESH_EXTERNAL
  resolution: STATIC
  endpoints:
    - address: 100.93.45.8
---
# VirtualService for minio
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: minio-external-vs
  namespace: istio-system
spec:
  hosts:
    - "minio.philippmhauptmann.me"
  gateways:
    - unified-ingress-gateway
  http:
    - route:
        - destination:
            host: minio.philippmhauptmann.me
            port:
              number: 443
---
apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: minio-external-dr
  namespace: istio-system
spec:
  host: minio.philippmhauptmann.me
  trafficPolicy:
    tls:
      mode: SIMPLE
      insecureSkipVerify: true
      sni: minio.lyrebird-sunfish.ts.net
